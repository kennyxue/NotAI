# AI写作助手应用需求文档

## 1. 产品概述
开发一个基于macOS平台的AI写作助手应用，使用Swift语言开发，集成文档编辑和AI辅助功能，为用户提供智能写作支持。

## 2. 功能需求

### 2.1 界面布局
- 左侧目录区域
  - 父层目录显示区
  - 子层目录显示区
  - 目录管理功能（新建、删除、重命名）
  
- 中央编辑区域
  - 文本编辑器
  - 支持基础格式化工具栏
    - 公式编辑
    - 表格功能
    - 笔和马克笔工具
  - Note area预览区域

- 右侧功能区
  - Chat对话界面
  - Composer写作界面
  - 历史对话记录显示
  - AI提示输入框

### 2.2 文件管理功能
- 目录管理功能
  - 新建目录和文件
    - 通过工具栏按钮新建
    - 通过右键菜单新建
    - 通过空白区域右键菜单新建
  - 重命名目录和文件
    - 通过右键菜单重命名
    - 通过双击标题重命名
    - 点击其他区域自动保存
    - 确保重命名后数据一致性
    - 自动处理重名冲突
  - 删除目录和文件
  - 拖拽调整目录和文件顺序
  - 目录排序功能（按名称、创建时间、修改时间等）
  - 目录展开/折叠状态记忆
  - 目录项选中状态持久化
  - 目录项图标显示
  - 目录项右键菜单功能
  - 数据一致性保证
    - 使用UUID确保唯一性
    - 维护引用完整性
    - 级联更新关联数据
    - 状态变更日志记录
- 支持文档的创建、打开、保存
- 文件目录树结构管理
- 文件导入导出功能
- 自动保存功能
- 文件版本历史记录

### 2.3 编辑功能
- 富文本编辑
  - 基础文本编辑功能
  - 文本格式化工具栏
    - 字体颜色选择
    - 文本加粗
    - 更多格式化选项（待实现）
  - 格式保存和恢复
  - 选择状态管理
  - 性能优化
- 图片插入与管理
  - 支持从本地文件插入图片
  - 支持图片在文档中显示与基本调整（如尺寸）
  - 支持AI根据上下文生成图片并插入文档
- Markdown语法支持
- 数学公式编辑
- 表格创建和编辑
- 手写笔记功能
- 文本高亮标注
- 撤销/重做功能

### 2.4 AI辅助功能
- 实时AI写作建议
- 智能内容补全
- 语法检查和优化
- 风格建议
- 上下文相关的写作提示
- AI对话支持
- 多轮对话历史记录
- AI模型选择与切换
  - 支持集成并选择不同的AI大语言模型（如OpenAI GPT系列，Google Gemini等）
- AI辅助图片生成

## 3. 非功能需求

### 3.1 性能需求
- 启动时间控制在3秒内
- 文件保存响应时间不超过1秒
- AI响应时间控制在2秒内
- 流畅的编辑体验，无卡顿

### 3.2 安全需求
- 本地数据加密存储
- AI对话数据安全传输
- 用户隐私保护
- 自动备份机制

### 3.3 兼容性需求
- 支持macOS 12.0及以上版本
- 适配不同分辨率显示器
- 支持深色模式

### 3.4 可用性需求
- 直观的用户界面
- 清晰的操作反馈
- 完整的快捷键支持
- 友好的错误提示

## 4. 技术要求
- 使用Swift和SwiftUI开发
- 采用MVVM架构模式
- 集成OpenAI API或其他AI服务
- 集成Google Gemini API
- 使用Core Data进行本地数据存储
- 支持iCloud同步
